/Library/Frameworks/Python.framework/Versions/3.12/lib/python3.12/site-packages/keras/src/layers/core/dense.py:92: UserWarning: Do not pass an `input_shape`/`input_dim` argument to a layer. When using Sequential models, prefer using an `Input(shape)` object as the first layer in the model instead.
  super().__init__(activity_regularizer=activity_regularizer, **kwargs)
/Library/Frameworks/Python.framework/Versions/3.12/lib/python3.12/site-packages/keras/src/layers/core/dense.py:92: UserWarning: Do not pass an `input_shape`/`input_dim` argument to a layer. When using Sequential models, prefer using an `Input(shape)` object as the first layer in the model instead.
  super().__init__(activity_regularizer=activity_regularizer, **kwargs)
/Library/Frameworks/Python.framework/Versions/3.12/lib/python3.12/site-packages/keras/src/layers/core/dense.py:92: UserWarning: Do not pass an `input_shape`/`input_dim` argument to a layer. When using Sequential models, prefer using an `Input(shape)` object as the first layer in the model instead.
  super().__init__(activity_regularizer=activity_regularizer, **kwargs)
/Library/Frameworks/Python.framework/Versions/3.12/lib/python3.12/site-packages/keras/src/layers/core/dense.py:92: UserWarning: Do not pass an `input_shape`/`input_dim` argument to a layer. When using Sequential models, prefer using an `Input(shape)` object as the first layer in the model instead.
  super().__init__(activity_regularizer=activity_regularizer, **kwargs)
/Library/Frameworks/Python.framework/Versions/3.12/lib/python3.12/site-packages/keras/src/layers/core/dense.py:92: UserWarning: Do not pass an `input_shape`/`input_dim` argument to a layer. When using Sequential models, prefer using an `Input(shape)` object as the first layer in the model instead.
  super().__init__(activity_regularizer=activity_regularizer, **kwargs)
/Library/Frameworks/Python.framework/Versions/3.12/lib/python3.12/site-packages/keras/src/layers/core/dense.py:92: UserWarning: Do not pass an `input_shape`/`input_dim` argument to a layer. When using Sequential models, prefer using an `Input(shape)` object as the first layer in the model instead.
  super().__init__(activity_regularizer=activity_regularizer, **kwargs)
/Library/Frameworks/Python.framework/Versions/3.12/lib/python3.12/site-packages/keras/src/layers/core/dense.py:92: UserWarning: Do not pass an `input_shape`/`input_dim` argument to a layer. When using Sequential models, prefer using an `Input(shape)` object as the first layer in the model instead.
  super().__init__(activity_regularizer=activity_regularizer, **kwargs)
/Library/Frameworks/Python.framework/Versions/3.12/lib/python3.12/site-packages/keras/src/layers/core/dense.py:92: UserWarning: Do not pass an `input_shape`/`input_dim` argument to a layer. When using Sequential models, prefer using an `Input(shape)` object as the first layer in the model instead.
  super().__init__(activity_regularizer=activity_regularizer, **kwargs)
/Library/Frameworks/Python.framework/Versions/3.12/lib/python3.12/site-packages/keras/src/layers/core/dense.py:92: UserWarning: Do not pass an `input_shape`/`input_dim` argument to a layer. When using Sequential models, prefer using an `Input(shape)` object as the first layer in the model instead.
  super().__init__(activity_regularizer=activity_regularizer, **kwargs)
/Library/Frameworks/Python.framework/Versions/3.12/lib/python3.12/site-packages/keras/src/layers/core/dense.py:92: UserWarning: Do not pass an `input_shape`/`input_dim` argument to a layer. When using Sequential models, prefer using an `Input(shape)` object as the first layer in the model instead.
  super().__init__(activity_regularizer=activity_regularizer, **kwargs)
/Library/Frameworks/Python.framework/Versions/3.12/lib/python3.12/site-packages/keras/src/layers/core/dense.py:92: UserWarning: Do not pass an `input_shape`/`input_dim` argument to a layer. When using Sequential models, prefer using an `Input(shape)` object as the first layer in the model instead.
  super().__init__(activity_regularizer=activity_regularizer, **kwargs)
/Library/Frameworks/Python.framework/Versions/3.12/lib/python3.12/site-packages/keras/src/layers/core/dense.py:92: UserWarning: Do not pass an `input_shape`/`input_dim` argument to a layer. When using Sequential models, prefer using an `Input(shape)` object as the first layer in the model instead.
  super().__init__(activity_regularizer=activity_regularizer, **kwargs)
/Library/Frameworks/Python.framework/Versions/3.12/lib/python3.12/site-packages/keras/src/layers/core/dense.py:92: UserWarning: Do not pass an `input_shape`/`input_dim` argument to a layer. When using Sequential models, prefer using an `Input(shape)` object as the first layer in the model instead.
  super().__init__(activity_regularizer=activity_regularizer, **kwargs)
/Library/Frameworks/Python.framework/Versions/3.12/lib/python3.12/site-packages/keras/src/layers/core/dense.py:92: UserWarning: Do not pass an `input_shape`/`input_dim` argument to a layer. When using Sequential models, prefer using an `Input(shape)` object as the first layer in the model instead.
  super().__init__(activity_regularizer=activity_regularizer, **kwargs)
/Library/Frameworks/Python.framework/Versions/3.12/lib/python3.12/site-packages/keras/src/layers/core/dense.py:92: UserWarning: Do not pass an `input_shape`/`input_dim` argument to a layer. When using Sequential models, prefer using an `Input(shape)` object as the first layer in the model instead.
  super().__init__(activity_regularizer=activity_regularizer, **kwargs)
/Library/Frameworks/Python.framework/Versions/3.12/lib/python3.12/site-packages/keras/src/layers/core/dense.py:92: UserWarning: Do not pass an `input_shape`/`input_dim` argument to a layer. When using Sequential models, prefer using an `Input(shape)` object as the first layer in the model instead.
  super().__init__(activity_regularizer=activity_regularizer, **kwargs)
/Library/Frameworks/Python.framework/Versions/3.12/lib/python3.12/site-packages/keras/src/layers/core/dense.py:92: UserWarning: Do not pass an `input_shape`/`input_dim` argument to a layer. When using Sequential models, prefer using an `Input(shape)` object as the first layer in the model instead.
  super().__init__(activity_regularizer=activity_regularizer, **kwargs)
/Library/Frameworks/Python.framework/Versions/3.12/lib/python3.12/site-packages/keras/src/layers/core/dense.py:92: UserWarning: Do not pass an `input_shape`/`input_dim` argument to a layer. When using Sequential models, prefer using an `Input(shape)` object as the first layer in the model instead.
  super().__init__(activity_regularizer=activity_regularizer, **kwargs)
/Library/Frameworks/Python.framework/Versions/3.12/lib/python3.12/site-packages/keras/src/layers/core/dense.py:92: UserWarning: Do not pass an `input_shape`/`input_dim` argument to a layer. When using Sequential models, prefer using an `Input(shape)` object as the first layer in the model instead.
  super().__init__(activity_regularizer=activity_regularizer, **kwargs)
/Library/Frameworks/Python.framework/Versions/3.12/lib/python3.12/site-packages/keras/src/layers/core/dense.py:92: UserWarning: Do not pass an `input_shape`/`input_dim` argument to a layer. When using Sequential models, prefer using an `Input(shape)` object as the first layer in the model instead.
  super().__init__(activity_regularizer=activity_regularizer, **kwargs)
2025-10-28 16:23:11.311372: I tensorflow/core/framework/local_rendezvous.cc:407] Local rendezvous is aborting with status: OUT_OF_RANGE: End of sequence
2025-10-28 16:23:12.869720: I tensorflow/core/framework/local_rendezvous.cc:407] Local rendezvous is aborting with status: OUT_OF_RANGE: End of sequence
2025-10-28 16:23:15.816674: I tensorflow/core/framework/local_rendezvous.cc:407] Local rendezvous is aborting with status: OUT_OF_RANGE: End of sequence
2025-10-28 16:23:22.480658: I tensorflow/core/framework/local_rendezvous.cc:407] Local rendezvous is aborting with status: OUT_OF_RANGE: End of sequence
2025-10-28 16:23:36.885172: I tensorflow/core/framework/local_rendezvous.cc:407] Local rendezvous is aborting with status: OUT_OF_RANGE: End of sequence
2025-10-28 16:24:05.304774: I tensorflow/core/framework/local_rendezvous.cc:407] Local rendezvous is aborting with status: OUT_OF_RANGE: End of sequence
2025-10-28 16:25:00.224424: I tensorflow/core/framework/local_rendezvous.cc:407] Local rendezvous is aborting with status: OUT_OF_RANGE: End of sequence
2025-10-28 16:26:54.849773: I tensorflow/core/framework/local_rendezvous.cc:407] Local rendezvous is aborting with status: OUT_OF_RANGE: End of sequence
2025-10-28 16:30:31.661720: I tensorflow/core/framework/local_rendezvous.cc:407] Local rendezvous is aborting with status: OUT_OF_RANGE: End of sequence
2025-10-28 16:38:20.541946: I tensorflow/core/framework/local_rendezvous.cc:407] Local rendezvous is aborting with status: OUT_OF_RANGE: End of sequence
Loading 52 subject files...
✓ Loaded Subject_Subject6.xlsx: 3803 samples
✓ Loaded Subject_Subject39.xlsx: 3676 samples
✓ Loaded Subject_Subject42.xlsx: 3999 samples
✓ Loaded Subject_Subject15.xlsx: 4289 samples
✓ Loaded Subject_Subject54.xlsx: 4119 samples
✓ Loaded Subject_Subject23.xlsx: 4065 samples
✓ Loaded Subject_Subject35.xlsx: 4035 samples
✓ Loaded Subject_Subject19.xlsx: 7163 samples
✓ Loaded Subject_Subject18.xlsx: 3600 samples
✓ Loaded Subject_Subject34.xlsx: 4082 samples
✓ Loaded Subject_Subject22.xlsx: 5787 samples
✓ Loaded Subject_Subject14.xlsx: 4308 samples
✓ Loaded Subject_Subject43.xlsx: 4092 samples
✓ Loaded Subject_Subject38.xlsx: 4220 samples
✓ Loaded Subject_Subject7.xlsx: 7739 samples
✓ Loaded Subject_Subject25.xlsx: 7666 samples
✓ Loaded Subject_Subject33.xlsx: 4779 samples
✓ Loaded Subject_Subject48.xlsx: 3674 samples
✓ Loaded Subject_Subject29.xlsx: 3942 samples
✓ Loaded Subject_Subject44.xlsx: 4668 samples
✓ Loaded Subject_Subject13.xlsx: 7716 samples
✓ Loaded Subject_Subject52.xlsx: 3424 samples
✓ Loaded Subject_Subject53.xlsx: 3175 samples
✓ Loaded Subject_Subject12.xlsx: 7863 samples
✓ Loaded Subject_Subject45.xlsx: 4076 samples
✓ Loaded Subject_Subject28.xlsx: 7763 samples
✓ Loaded Subject_Subject49.xlsx: 2609 samples
✓ Loaded Subject_Subject32.xlsx: 3954 samples
✓ Loaded Subject_Subject24.xlsx: 3606 samples
✓ Loaded Subject_Subject31.xlsx: 4074 samples
✓ Loaded Subject_Subject27.xlsx: 7478 samples
✓ Loaded Subject_Subject50.xlsx: 2916 samples
✓ Loaded Subject_Subject11.xlsx: 3830 samples
✓ Loaded Subject_Subject46.xlsx: 4283 samples
✓ Loaded Subject_Subject3.xlsx: 3877 samples
✓ Loaded Subject_Subject47.xlsx: 4203 samples
✓ Loaded Subject_Subject10.xlsx: 5699 samples
✓ Loaded Subject_Subject51.xlsx: 4044 samples
✓ Loaded Subject_Subject26.xlsx: 4217 samples
✓ Loaded Subject_Subject30.xlsx: 4208 samples
✓ Loaded Subject_Subject17.xlsx: 7199 samples
✓ Loaded Subject_Subject40.xlsx: 4236 samples
✓ Loaded Subject_Subject4.xlsx: 6969 samples
✓ Loaded Subject_Subject37.xlsx: 4243 samples
✓ Loaded Subject_Subject8.xlsx: 4268 samples
✓ Loaded Subject_Subject21.xlsx: 4341 samples
✓ Loaded Subject_Subject20.xlsx: 7933 samples
✓ Loaded Subject_Subject9.xlsx: 7130 samples
✓ Loaded Subject_Subject36.xlsx: 4197 samples
✓ Loaded Subject_Subject5.xlsx: 4258 samples
✓ Loaded Subject_Subject41.xlsx: 2847 samples
✓ Loaded Subject_Subject16.xlsx: 4195 samples
Available clients: ['Subject6', 'Subject39', 'Subject42', 'Subject15', 'Subject54', 'Subject23', 'Subject35', 'Subject19', 'Subject18', 'Subject34', 'Subject22', 'Subject14', 'Subject43', 'Subject38', 'Subject7', 'Subject25', 'Subject33', 'Subject48', 'Subject29', 'Subject44', 'Subject13', 'Subject52', 'Subject53', 'Subject12', 'Subject45', 'Subject28', 'Subject49', 'Subject32', 'Subject24', 'Subject31', 'Subject27', 'Subject50', 'Subject11', 'Subject46', 'Subject3', 'Subject47', 'Subject10', 'Subject51', 'Subject26', 'Subject30', 'Subject17', 'Subject40', 'Subject4', 'Subject37', 'Subject8', 'Subject21', 'Subject20', 'Subject9', 'Subject36', 'Subject5', 'Subject41', 'Subject16']
=== Starting File-Based Federated Learning Benchmark ===
Available subjects: 52
Strategies: ['fedavg', 'fedprox', 'fedsgd', 'fedclusterproxxai']

--- Running FedAvg ---
Running fedavg strategy...
Running 50 rounds with 52 clients
Client Subject6: 3042 train, 761 val samples
Client Subject39: 2940 train, 736 val samples
Client Subject42: 3199 train, 800 val samples
Client Subject15: 3431 train, 858 val samples
Client Subject54: 3295 train, 824 val samples
Client Subject23: 3252 train, 813 val samples
Client Subject35: 3228 train, 807 val samples
Client Subject19: 5730 train, 1433 val samples
Client Subject18: 2880 train, 720 val samples
Client Subject34: 3265 train, 817 val samples
Round 1/50
  Round 1 - Loss: 0.0444
Round 2/50
  Round 2 - Loss: 0.0330
Round 3/50
  Round 3 - Loss: 0.0253
Round 4/50
  Round 4 - Loss: 0.0218
Round 5/50
  Round 5 - Loss: 0.0218
Round 6/50
  Round 6 - Loss: 0.0207
Round 7/50
  Round 7 - Loss: 0.0208
Round 8/50
  Round 8 - Loss: 0.0209
Round 9/50
  Round 9 - Loss: 0.0217
Round 10/50
  Round 10 - Loss: 0.0207
Round 11/50
  Round 11 - Loss: 0.0214
Round 12/50
  Round 12 - Loss: 0.0203
Round 13/50
  Round 13 - Loss: 0.0219
Round 14/50
  Round 14 - Loss: 0.0220
Round 15/50
  Round 15 - Loss: 0.0215
Round 16/50
  Round 16 - Loss: 0.0215
Round 17/50
  Round 17 - Loss: 0.0219
Round 18/50
  Round 18 - Loss: 0.0214
Round 19/50
  Round 19 - Loss: 0.0219
Round 20/50
  Round 20 - Loss: 0.0222
Round 21/50
  Round 21 - Loss: 0.0223
Round 22/50
  Round 22 - Loss: 0.0228
Round 23/50
  Round 23 - Loss: 0.0218
Round 24/50
  Round 24 - Loss: 0.0211
Round 25/50
  Round 25 - Loss: 0.0214
Round 26/50
  Round 26 - Loss: 0.0210
Round 27/50
  Round 27 - Loss: 0.0222
Round 28/50
  Round 28 - Loss: 0.0219
Round 29/50
  Round 29 - Loss: 0.0213
Round 30/50
  Round 30 - Loss: 0.0218
Round 31/50
  Round 31 - Loss: 0.0218
Round 32/50
  Round 32 - Loss: 0.0219
Round 33/50
  Round 33 - Loss: 0.0215
Round 34/50
  Round 34 - Loss: 0.0210
Round 35/50
  Round 35 - Loss: 0.0210
Round 36/50
  Round 36 - Loss: 0.0219
Round 37/50
  Round 37 - Loss: 0.0213
Round 38/50
  Round 38 - Loss: 0.0215
Round 39/50
  Round 39 - Loss: 0.0215
Round 40/50
  Round 40 - Loss: 0.0224
Round 41/50
  Round 41 - Loss: 0.0213
Round 42/50
  Round 42 - Loss: 0.0210
Round 43/50
  Round 43 - Loss: 0.0204
Round 44/50
  Round 44 - Loss: 0.0225
Round 45/50
  Round 45 - Loss: 0.0216
Round 46/50
  Round 46 - Loss: 0.0223
Round 47/50
  Round 47 - Loss: 0.0200
Round 48/50
  Round 48 - Loss: 0.0211
Round 49/50
  Round 49 - Loss: 0.0211
Round 50/50
  Round 50 - Loss: 0.0221
  Results saved to experiments/cgm_fl_benchmark/fedavg/results/results.json

--- Running FedProx ---
Running fedprox strategy...
Running 50 rounds with 52 clients
Client Subject6: 3042 train, 761 val samples
Client Subject39: 2940 train, 736 val samples
Client Subject42: 3199 train, 800 val samples
Client Subject15: 3431 train, 858 val samples
Client Subject54: 3295 train, 824 val samples
Client Subject23: 3252 train, 813 val samples
Client Subject35: 3228 train, 807 val samples
Client Subject19: 5730 train, 1433 val samples
Client Subject18: 2880 train, 720 val samples
Client Subject34: 3265 train, 817 val samples
Round 1/50
  Round 1 - Loss: 0.0376
Round 2/50
  Round 2 - Loss: 0.0318
Round 3/50
  Round 3 - Loss: 0.0289
Round 4/50
  Round 4 - Loss: 0.0267
Round 5/50
  Round 5 - Loss: 0.0256
Round 6/50
  Round 6 - Loss: 0.0244
Round 7/50
  Round 7 - Loss: 0.0232
Round 8/50
  Round 8 - Loss: 0.0226
Round 9/50
  Round 9 - Loss: 0.0216
Round 10/50
  Round 10 - Loss: 0.0213
Round 11/50
  Round 11 - Loss: 0.0209
Round 12/50
  Round 12 - Loss: 0.0218
Round 13/50
  Round 13 - Loss: 0.0204
Round 14/50
  Round 14 - Loss: 0.0212
Round 15/50
  Round 15 - Loss: 0.0209
Round 16/50
  Round 16 - Loss: 0.0208
Round 17/50
  Round 17 - Loss: 0.0212
Round 18/50
  Round 18 - Loss: 0.0207
Round 19/50
  Round 19 - Loss: 0.0199
Round 20/50
  Round 20 - Loss: 0.0210
Round 21/50
  Round 21 - Loss: 0.0205
Round 22/50
  Round 22 - Loss: 0.0208
Round 23/50
  Round 23 - Loss: 0.0215
Round 24/50
  Round 24 - Loss: 0.0210
Round 25/50
  Round 25 - Loss: 0.0202
Round 26/50
  Round 26 - Loss: 0.0204
Round 27/50
  Round 27 - Loss: 0.0205
Round 28/50
  Round 28 - Loss: 0.0202
Round 29/50
  Round 29 - Loss: 0.0208
Round 30/50
  Round 30 - Loss: 0.0197
Round 31/50
  Round 31 - Loss: 0.0209
Round 32/50
  Round 32 - Loss: 0.0206
Round 33/50
  Round 33 - Loss: 0.0198
Round 34/50
  Round 34 - Loss: 0.0196
Round 35/50
  Round 35 - Loss: 0.0190
Round 36/50
  Round 36 - Loss: 0.0195
Round 37/50
  Round 37 - Loss: 0.0188
Round 38/50
  Round 38 - Loss: 0.0190
Round 39/50
  Round 39 - Loss: 0.0193
Round 40/50
  Round 40 - Loss: 0.0194
Round 41/50
  Round 41 - Loss: 0.0196
Round 42/50
  Round 42 - Loss: 0.0187
Round 43/50
  Round 43 - Loss: 0.0187
Round 44/50
  Round 44 - Loss: 0.0192
Round 45/50
  Round 45 - Loss: 0.0194
Round 46/50
  Round 46 - Loss: 0.0195
Round 47/50
  Round 47 - Loss: 0.0201
Round 48/50
  Round 48 - Loss: 0.0197/Library/Frameworks/Python.framework/Versions/3.12/lib/python3.12/site-packages/keras/src/layers/core/dense.py:92: UserWarning: Do not pass an `input_shape`/`input_dim` argument to a layer. When using Sequential models, prefer using an `Input(shape)` object as the first layer in the model instead.
  super().__init__(activity_regularizer=activity_regularizer, **kwargs)
/Library/Frameworks/Python.framework/Versions/3.12/lib/python3.12/site-packages/keras/src/layers/core/dense.py:92: UserWarning: Do not pass an `input_shape`/`input_dim` argument to a layer. When using Sequential models, prefer using an `Input(shape)` object as the first layer in the model instead.
  super().__init__(activity_regularizer=activity_regularizer, **kwargs)
/Library/Frameworks/Python.framework/Versions/3.12/lib/python3.12/site-packages/keras/src/layers/core/dense.py:92: UserWarning: Do not pass an `input_shape`/`input_dim` argument to a layer. When using Sequential models, prefer using an `Input(shape)` object as the first layer in the model instead.
  super().__init__(activity_regularizer=activity_regularizer, **kwargs)
/Library/Frameworks/Python.framework/Versions/3.12/lib/python3.12/site-packages/keras/src/layers/core/dense.py:92: UserWarning: Do not pass an `input_shape`/`input_dim` argument to a layer. When using Sequential models, prefer using an `Input(shape)` object as the first layer in the model instead.
  super().__init__(activity_regularizer=activity_regularizer, **kwargs)
/Library/Frameworks/Python.framework/Versions/3.12/lib/python3.12/site-packages/keras/src/layers/core/dense.py:92: UserWarning: Do not pass an `input_shape`/`input_dim` argument to a layer. When using Sequential models, prefer using an `Input(shape)` object as the first layer in the model instead.
  super().__init__(activity_regularizer=activity_regularizer, **kwargs)
/Library/Frameworks/Python.framework/Versions/3.12/lib/python3.12/site-packages/keras/src/layers/core/dense.py:92: UserWarning: Do not pass an `input_shape`/`input_dim` argument to a layer. When using Sequential models, prefer using an `Input(shape)` object as the first layer in the model instead.
  super().__init__(activity_regularizer=activity_regularizer, **kwargs)
/Library/Frameworks/Python.framework/Versions/3.12/lib/python3.12/site-packages/keras/src/layers/core/dense.py:92: UserWarning: Do not pass an `input_shape`/`input_dim` argument to a layer. When using Sequential models, prefer using an `Input(shape)` object as the first layer in the model instead.
  super().__init__(activity_regularizer=activity_regularizer, **kwargs)
/Library/Frameworks/Python.framework/Versions/3.12/lib/python3.12/site-packages/keras/src/layers/core/dense.py:92: UserWarning: Do not pass an `input_shape`/`input_dim` argument to a layer. When using Sequential models, prefer using an `Input(shape)` object as the first layer in the model instead.
  super().__init__(activity_regularizer=activity_regularizer, **kwargs)
/Library/Frameworks/Python.framework/Versions/3.12/lib/python3.12/site-packages/keras/src/layers/core/dense.py:92: UserWarning: Do not pass an `input_shape`/`input_dim` argument to a layer. When using Sequential models, prefer using an `Input(shape)` object as the first layer in the model instead.
  super().__init__(activity_regularizer=activity_regularizer, **kwargs)
/Library/Frameworks/Python.framework/Versions/3.12/lib/python3.12/site-packages/keras/src/layers/core/dense.py:92: UserWarning: Do not pass an `input_shape`/`input_dim` argument to a layer. When using Sequential models, prefer using an `Input(shape)` object as the first layer in the model instead.
  super().__init__(activity_regularizer=activity_regularizer, **kwargs)
/Library/Frameworks/Python.framework/Versions/3.12/lib/python3.12/site-packages/keras/src/layers/core/dense.py:92: UserWarning: Do not pass an `input_shape`/`input_dim` argument to a layer. When using Sequential models, prefer using an `Input(shape)` object as the first layer in the model instead.
  super().__init__(activity_regularizer=activity_regularizer, **kwargs)
/Library/Frameworks/Python.framework/Versions/3.12/lib/python3.12/site-packages/keras/src/layers/core/dense.py:92: UserWarning: Do not pass an `input_shape`/`input_dim` argument to a layer. When using Sequential models, prefer using an `Input(shape)` object as the first layer in the model instead.
  super().__init__(activity_regularizer=activity_regularizer, **kwargs)
/Library/Frameworks/Python.framework/Versions/3.12/lib/python3.12/site-packages/keras/src/layers/core/dense.py:92: UserWarning: Do not pass an `input_shape`/`input_dim` argument to a layer. When using Sequential models, prefer using an `Input(shape)` object as the first layer in the model instead.
  super().__init__(activity_regularizer=activity_regularizer, **kwargs)
/Library/Frameworks/Python.framework/Versions/3.12/lib/python3.12/site-packages/keras/src/layers/core/dense.py:92: UserWarning: Do not pass an `input_shape`/`input_dim` argument to a layer. When using Sequential models, prefer using an `Input(shape)` object as the first layer in the model instead.
  super().__init__(activity_regularizer=activity_regularizer, **kwargs)
/Library/Frameworks/Python.framework/Versions/3.12/lib/python3.12/site-packages/keras/src/layers/core/dense.py:92: UserWarning: Do not pass an `input_shape`/`input_dim` argument to a layer. When using Sequential models, prefer using an `Input(shape)` object as the first layer in the model instead.
  super().__init__(activity_regularizer=activity_regularizer, **kwargs)
/Library/Frameworks/Python.framework/Versions/3.12/lib/python3.12/site-packages/keras/src/layers/core/dense.py:92: UserWarning: Do not pass an `input_shape`/`input_dim` argument to a layer. When using Sequential models, prefer using an `Input(shape)` object as the first layer in the model instead.
  super().__init__(activity_regularizer=activity_regularizer, **kwargs)
/Library/Frameworks/Python.framework/Versions/3.12/lib/python3.12/site-packages/keras/src/layers/core/dense.py:92: UserWarning: Do not pass an `input_shape`/`input_dim` argument to a layer. When using Sequential models, prefer using an `Input(shape)` object as the first layer in the model instead.
  super().__init__(activity_regularizer=activity_regularizer, **kwargs)
/Library/Frameworks/Python.framework/Versions/3.12/lib/python3.12/site-packages/keras/src/layers/core/dense.py:92: UserWarning: Do not pass an `input_shape`/`input_dim` argument to a layer. When using Sequential models, prefer using an `Input(shape)` object as the first layer in the model instead.
  super().__init__(activity_regularizer=activity_regularizer, **kwargs)
/Library/Frameworks/Python.framework/Versions/3.12/lib/python3.12/site-packages/keras/src/layers/core/dense.py:92: UserWarning: Do not pass an `input_shape`/`input_dim` argument to a layer. When using Sequential models, prefer using an `Input(shape)` object as the first layer in the model instead.
  super().__init__(activity_regularizer=activity_regularizer, **kwargs)
/Library/Frameworks/Python.framework/Versions/3.12/lib/python3.12/site-packages/keras/src/layers/core/dense.py:92: UserWarning: Do not pass an `input_shape`/`input_dim` argument to a layer. When using Sequential models, prefer using an `Input(shape)` object as the first layer in the model instead.
  super().__init__(activity_regularizer=activity_regularizer, **kwargs)
2025-10-29 12:15:08.191458: I tensorflow/core/framework/local_rendezvous.cc:407] Local rendezvous is aborting with status: OUT_OF_RANGE: End of sequence

Round 49/50
  Round 49 - Loss: 0.0192
Round 50/50
  Round 50 - Loss: 0.0197
  Results saved to experiments/cgm_fl_benchmark/fedprox/results/results.json

--- Running FedSGD ---
Running fedsgd strategy...
Running 50 rounds with 52 clients
Client Subject6: 3042 train, 761 val samples
Client Subject39: 2940 train, 736 val samples
Client Subject42: 3199 train, 800 val samples
Client Subject15: 3431 train, 858 val samples
Client Subject54: 3295 train, 824 val samples
Client Subject23: 3252 train, 813 val samples
Client Subject35: 3228 train, 807 val samples
Client Subject19: 5730 train, 1433 val samples
Client Subject18: 2880 train, 720 val samples
Client Subject34: 3265 train, 817 val samples
Round 1/50
  Round 1 - Loss: 0.0584
Round 2/50
  Round 2 - Loss: 0.0334
Round 3/50
  Round 3 - Loss: 0.0300
Round 4/50
  Round 4 - Loss: 0.0268
Round 5/50
  Round 5 - Loss: 0.0252
Round 6/50
  Round 6 - Loss: 0.0231
Round 7/50
  Round 7 - Loss: 0.0224
Round 8/50
  Round 8 - Loss: 0.0214
Round 9/50
  Round 9 - Loss: 0.0218
Round 10/50
  Round 10 - Loss: 0.0210
Round 11/50
  Round 11 - Loss: 0.0204
Round 12/50
  Round 12 - Loss: 0.0200
Round 13/50
  Round 13 - Loss: 0.0204
Round 14/50
  Round 14 - Loss: 0.0206
Round 15/50
  Round 15 - Loss: 0.0198
Round 16/50
  Round 16 - Loss: 0.0196
Round 17/50
  Round 17 - Loss: 0.0198
Round 18/50
  Round 18 - Loss: 0.0185
Round 19/50
  Round 19 - Loss: 0.0195
Round 20/50
  Round 20 - Loss: 0.0184
Round 21/50
  Round 21 - Loss: 0.0183
Round 22/50
  Round 22 - Loss: 0.0178
Round 23/50
  Round 23 - Loss: 0.0183
Round 24/50
  Round 24 - Loss: 0.0171
Round 25/50
  Round 25 - Loss: 0.0169
Round 26/50
  Round 26 - Loss: 0.0169
Round 27/50
  Round 27 - Loss: 0.0175
Round 28/50
  Round 28 - Loss: 0.0172
Round 29/50
  Round 29 - Loss: 0.0171
Round 30/50
  Round 30 - Loss: 0.0165
Round 31/50
  Round 31 - Loss: 0.0172
Round 32/50
  Round 32 - Loss: 0.0172
Round 33/50
  Round 33 - Loss: 0.0178
Round 34/50
  Round 34 - Loss: 0.0175
Round 35/50
  Round 35 - Loss: 0.0174
Round 36/50
  Round 36 - Loss: 0.0183
Round 37/50
  Round 37 - Loss: 0.0174
Round 38/50
  Round 38 - Loss: 0.0172
Round 39/50
  Round 39 - Loss: 0.0178
Round 40/50
  Round 40 - Loss: 0.0164
Round 41/50
  Round 41 - Loss: 0.0180
Round 42/50
  Round 42 - Loss: 0.0178
Round 43/50
  Round 43 - Loss: 0.0176
Round 44/50
  Round 44 - Loss: 0.0187
Round 45/50
  Round 45 - Loss: 0.0184
Round 46/50
  Round 46 - Loss: 0.0172
Round 47/50
  Round 47 - Loss: 0.0172
Round 48/50
  Round 48 - Loss: 0.0182
Round 49/50
  Round 49 - Loss: 0.0189
Round 50/50
  Round 50 - Loss: 0.0179
  Results saved to experiments/cgm_fl_benchmark/fedsgd/results/results.json

--- Running FedClusterProxXAI ---
Running fedclusterproxxai strategy...
Running 50 rounds with 52 clients
Client Subject6: 3042 train, 761 val samples
Client Subject39: 2940 train, 736 val samples
Client Subject42: 3199 train, 800 val samples
Client Subject15: 3431 train, 858 val samples
Client Subject54: 3295 train, 824 val samples
Client Subject23: 3252 train, 813 val samples
Client Subject35: 3228 train, 807 val samples
Client Subject19: 5730 train, 1433 val samples
Client Subject18: 2880 train, 720 val samples
Client Subject34: 3265 train, 817 val samples
Round 1/50
  Round 1 - Loss: 0.0499
Round 2/50
  Round 2 - Loss: 0.0334
Round 3/50
  Round 3 - Loss: 0.0257
Round 4/50
  Round 4 - Loss: 0.0236
Round 5/50
  Round 5 - Loss: 0.0221
Round 6/50
  Round 6 - Loss: 0.0213
Round 7/50
  Round 7 - Loss: 0.0222
Round 8/50
  Round 8 - Loss: 0.0209
Round 9/50
  Round 9 - Loss: 0.0216
Round 10/50
  Round 10 - Loss: 0.0204
Round 11/50
  Round 11 - Loss: 0.0210
Round 12/50
  Round 12 - Loss: 0.0208
Round 13/50
  Round 13 - Loss: 0.0199
Round 14/50
  Round 14 - Loss: 0.0203
Round 15/50
  Round 15 - Loss: 0.0201
Round 16/50
  Round 16 - Loss: 0.0207
Round 17/50
  Round 17 - Loss: 0.0193
Round 18/50
  Round 18 - Loss: 0.0208
Round 19/50
  Round 19 - Loss: 0.0195
Round 20/50
  Round 20 - Loss: 0.0202
Round 21/50
  Round 21 - Loss: 0.0197
Round 22/50
  Round 22 - Loss: 0.0209
Round 23/50
  Round 23 - Loss: 0.0201
Round 24/50
  Round 24 - Loss: 0.0204
Round 25/50
  Round 25 - Loss: 0.0199
Round 26/50
  Round 26 - Loss: 0.0194
Round 27/50
  Round 27 - Loss: 0.0204
Round 28/50
  Round 28 - Loss: 0.0201
Round 29/50
  Round 29 - Loss: 0.0196
Round 30/50
  Round 30 - Loss: 0.0202
Round 31/50
  Round 31 - Loss: 0.0194
Round 32/50
  Round 32 - Loss: 0.0199
Round 33/50
  Round 33 - Loss: 0.0196
Round 34/50
  Round 34 - Loss: 0.0192
Round 35/50
  Round 35 - Loss: 0.0199
Round 36/50
  Round 36 - Loss: 0.0193
Round 37/50
  Round 37 - Loss: 0.0198
Round 38/50
  Round 38 - Loss: 0.0190
Round 39/50
  Round 39 - Loss: 0.0192
Round 40/50
  Round 40 - Loss: 0.0210
Round 41/50
  Round 41 - Loss: 0.0199
Round 42/50
  Round 42 - Loss: 0.0200
Round 43/50
  Round 43 - Loss: 0.0193
Round 44/50
  Round 44 - Loss: 0.0204
Round 45/50
  Round 45 - Loss: 0.0204
Round 46/50
  Round 46 - Loss: 0.0199
Round 47/50
  Round 47 - Loss: 0.0201
Round 48/50
  Round 48 - Loss: 0.0203
Round 49/50
  Round 49 - Loss: 0.0192
Round 50/50
  Round 50 - Loss: 0.0197
  Results saved to experiments/cgm_fl_benchmark/fedclusterproxxai/results/results.json
  Cluster metadata saved to experiments/cgm_fl_benchmark/fedclusterproxxai/models/cluster_metadata.json

=== Benchmark Completed ===

==========================================================================================
COMPARATIVE RESULTS SUMMARY
==========================================================================================

Strategy: FedAvg
Execution Time: 68.27s

Performance Metrics:
  Final Loss: 0.0221
  MAE: 0.1083
  RMSE: 0.1349

XAI Metrics:
  Importance Score: 0.0299
  Stability Score: 0.9551
  Faithfulness Score: 0.2151
  Overall XAI Score: 0.4000
  Prediction Stability: 0.0045
  Local Stability: 0.0020
  Faithfulness: 0.0430
  Monotonicity: 0.9895
------------------------------------------------------------------------------------------

Strategy: FedProx
Execution Time: 1351.69s

Performance Metrics:
  Final Loss: 0.0197
  MAE: 0.1027
  RMSE: 0.1277

XAI Metrics:
  Importance Score: 0.0208
  Stability Score: 0.9543
  Faithfulness Score: 0.2141
  Overall XAI Score: 0.3964
  Prediction Stability: 0.0046
  Local Stability: 0.0014
  Faithfulness: 0.0428
  Monotonicity: 0.9927
------------------------------------------------------------------------------------------

Strategy: FedSGD
Execution Time: 62.17s

Performance Metrics:
  Final Loss: 0.0179
  MAE: 0.0984
  RMSE: 0.1248

XAI Metrics:
  Importance Score: 0.0430
  Stability Score: 0.9445
  Faithfulness Score: 0.1681
  Overall XAI Score: 0.3852
  Prediction Stability: 0.0055
  Local Stability: 0.0029
  Faithfulness: 0.0336
  Monotonicity: 0.9952
------------------------------------------------------------------------------------------

Strategy: FedClusterProxXAI
Execution Time: 71750.45s

Performance Metrics:
  Final Loss: 0.0197
  MAE: 0.1069
  RMSE: 0.1306

XAI Metrics:
  Importance Score: 0.0253
  Stability Score: 0.9238
  Faithfulness Score: 0.4660
  Overall XAI Score: 0.4717
  Prediction Stability: 0.0076
  Local Stability: 0.0016
  Faithfulness: 0.0932
  Monotonicity: 0.9958
------------------------------------------------------------------------------------------
