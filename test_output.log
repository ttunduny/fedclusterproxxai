/Library/Frameworks/Python.framework/Versions/3.12/lib/python3.12/site-packages/keras/src/layers/core/dense.py:92: UserWarning: Do not pass an `input_shape`/`input_dim` argument to a layer. When using Sequential models, prefer using an `Input(shape)` object as the first layer in the model instead.
  super().__init__(activity_regularizer=activity_regularizer, **kwargs)
/Library/Frameworks/Python.framework/Versions/3.12/lib/python3.12/site-packages/keras/src/layers/core/dense.py:92: UserWarning: Do not pass an `input_shape`/`input_dim` argument to a layer. When using Sequential models, prefer using an `Input(shape)` object as the first layer in the model instead.
  super().__init__(activity_regularizer=activity_regularizer, **kwargs)
/Library/Frameworks/Python.framework/Versions/3.12/lib/python3.12/site-packages/keras/src/layers/core/dense.py:92: UserWarning: Do not pass an `input_shape`/`input_dim` argument to a layer. When using Sequential models, prefer using an `Input(shape)` object as the first layer in the model instead.
  super().__init__(activity_regularizer=activity_regularizer, **kwargs)
/Library/Frameworks/Python.framework/Versions/3.12/lib/python3.12/site-packages/keras/src/layers/core/dense.py:92: UserWarning: Do not pass an `input_shape`/`input_dim` argument to a layer. When using Sequential models, prefer using an `Input(shape)` object as the first layer in the model instead.
  super().__init__(activity_regularizer=activity_regularizer, **kwargs)
/Library/Frameworks/Python.framework/Versions/3.12/lib/python3.12/site-packages/keras/src/layers/core/dense.py:92: UserWarning: Do not pass an `input_shape`/`input_dim` argument to a layer. When using Sequential models, prefer using an `Input(shape)` object as the first layer in the model instead.
  super().__init__(activity_regularizer=activity_regularizer, **kwargs)
/Library/Frameworks/Python.framework/Versions/3.12/lib/python3.12/site-packages/keras/src/layers/core/dense.py:92: UserWarning: Do not pass an `input_shape`/`input_dim` argument to a layer. When using Sequential models, prefer using an `Input(shape)` object as the first layer in the model instead.
  super().__init__(activity_regularizer=activity_regularizer, **kwargs)
/Library/Frameworks/Python.framework/Versions/3.12/lib/python3.12/site-packages/keras/src/layers/core/dense.py:92: UserWarning: Do not pass an `input_shape`/`input_dim` argument to a layer. When using Sequential models, prefer using an `Input(shape)` object as the first layer in the model instead.
  super().__init__(activity_regularizer=activity_regularizer, **kwargs)
/Library/Frameworks/Python.framework/Versions/3.12/lib/python3.12/site-packages/keras/src/layers/core/dense.py:92: UserWarning: Do not pass an `input_shape`/`input_dim` argument to a layer. When using Sequential models, prefer using an `Input(shape)` object as the first layer in the model instead.
  super().__init__(activity_regularizer=activity_regularizer, **kwargs)
/Library/Frameworks/Python.framework/Versions/3.12/lib/python3.12/site-packages/keras/src/layers/core/dense.py:92: UserWarning: Do not pass an `input_shape`/`input_dim` argument to a layer. When using Sequential models, prefer using an `Input(shape)` object as the first layer in the model instead.
  super().__init__(activity_regularizer=activity_regularizer, **kwargs)
/Library/Frameworks/Python.framework/Versions/3.12/lib/python3.12/site-packages/keras/src/layers/core/dense.py:92: UserWarning: Do not pass an `input_shape`/`input_dim` argument to a layer. When using Sequential models, prefer using an `Input(shape)` object as the first layer in the model instead.
  super().__init__(activity_regularizer=activity_regularizer, **kwargs)
/Library/Frameworks/Python.framework/Versions/3.12/lib/python3.12/site-packages/keras/src/layers/core/dense.py:92: UserWarning: Do not pass an `input_shape`/`input_dim` argument to a layer. When using Sequential models, prefer using an `Input(shape)` object as the first layer in the model instead.
  super().__init__(activity_regularizer=activity_regularizer, **kwargs)
Traceback (most recent call last):
  File "<string>", line 11, in <module>
  File "/Users/gtlabs/Desktop/Experiments2/src/fl_benchmark.py", line 143, in run_benchmark
    strategy_results = self._run_strategy(strategy_key, strategy_info)
                       ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/Users/gtlabs/Desktop/Experiments2/src/fl_benchmark.py", line 308, in _run_strategy
    updated_params, num_samples, metrics = client.fit(cluster_params, config)
                                           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/Users/gtlabs/Desktop/Experiments2/src/strategies.py", line 79, in fit
    self.set_parameters(parameters)
  File "/Users/gtlabs/Desktop/Experiments2/src/strategies.py", line 75, in set_parameters
    var.assign(param)
  File "/Library/Frameworks/Python.framework/Versions/3.12/lib/python3.12/site-packages/keras/src/backend/common/variables.py", line 281, in assign
    raise ValueError(
ValueError: The shape of the target variable and the shape of the target value in `variable.assign(value)` must match. variable.shape=(128, 64), Received: value.shape=(128,). Target variable: <Variable path=sequential/dense_1/kernel, shape=(128, 64), dtype=float32, value=[[ 0.14470099  0.12621616 -0.05735642 ...  0.0625551   0.08802091
   0.1172943 ]
 [ 0.00802454 -0.04674464 -0.15443482 ...  0.06649378 -0.1548324
  -0.03684191]
 [-0.12212963  0.14393894 -0.007351   ... -0.09242509  0.0658896
   0.08258449]
 ...
 [-0.05018342 -0.00616646  0.15937321 ...  0.06688511 -0.02956079
  -0.17466387]
 [ 0.02402568  0.1482005   0.10507099 ... -0.142696   -0.02713625
   0.01619269]
 [ 0.12800758 -0.15603484  0.06860854 ...  0.16198497  0.06966878
   0.07173133]]>
Loading 52 subject files...
✓ Loaded Subject_Subject6.xlsx: 3803 samples
✓ Loaded Subject_Subject39.xlsx: 3676 samples
✓ Loaded Subject_Subject42.xlsx: 3999 samples
✓ Loaded Subject_Subject15.xlsx: 4289 samples
✓ Loaded Subject_Subject54.xlsx: 4119 samples
✓ Loaded Subject_Subject23.xlsx: 4065 samples
✓ Loaded Subject_Subject35.xlsx: 4035 samples
✓ Loaded Subject_Subject19.xlsx: 7163 samples
✓ Loaded Subject_Subject18.xlsx: 3600 samples
✓ Loaded Subject_Subject34.xlsx: 4082 samples
✓ Loaded Subject_Subject22.xlsx: 5787 samples
✓ Loaded Subject_Subject14.xlsx: 4308 samples
✓ Loaded Subject_Subject43.xlsx: 4092 samples
✓ Loaded Subject_Subject38.xlsx: 4220 samples
✓ Loaded Subject_Subject7.xlsx: 7739 samples
✓ Loaded Subject_Subject25.xlsx: 7666 samples
✓ Loaded Subject_Subject33.xlsx: 4779 samples
✓ Loaded Subject_Subject48.xlsx: 3674 samples
✓ Loaded Subject_Subject29.xlsx: 3942 samples
✓ Loaded Subject_Subject44.xlsx: 4668 samples
✓ Loaded Subject_Subject13.xlsx: 7716 samples
✓ Loaded Subject_Subject52.xlsx: 3424 samples
✓ Loaded Subject_Subject53.xlsx: 3175 samples
✓ Loaded Subject_Subject12.xlsx: 7863 samples
✓ Loaded Subject_Subject45.xlsx: 4076 samples
✓ Loaded Subject_Subject28.xlsx: 7763 samples
✓ Loaded Subject_Subject49.xlsx: 2609 samples
✓ Loaded Subject_Subject32.xlsx: 3954 samples
✓ Loaded Subject_Subject24.xlsx: 3606 samples
✓ Loaded Subject_Subject31.xlsx: 4074 samples
✓ Loaded Subject_Subject27.xlsx: 7478 samples
✓ Loaded Subject_Subject50.xlsx: 2916 samples
✓ Loaded Subject_Subject11.xlsx: 3830 samples
✓ Loaded Subject_Subject46.xlsx: 4283 samples
✓ Loaded Subject_Subject3.xlsx: 3877 samples
✓ Loaded Subject_Subject47.xlsx: 4203 samples
✓ Loaded Subject_Subject10.xlsx: 5699 samples
✓ Loaded Subject_Subject51.xlsx: 4044 samples
✓ Loaded Subject_Subject26.xlsx: 4217 samples
✓ Loaded Subject_Subject30.xlsx: 4208 samples
✓ Loaded Subject_Subject17.xlsx: 7199 samples
✓ Loaded Subject_Subject40.xlsx: 4236 samples
✓ Loaded Subject_Subject4.xlsx: 6969 samples
✓ Loaded Subject_Subject37.xlsx: 4243 samples
✓ Loaded Subject_Subject8.xlsx: 4268 samples
✓ Loaded Subject_Subject21.xlsx: 4341 samples
✓ Loaded Subject_Subject20.xlsx: 7933 samples
✓ Loaded Subject_Subject9.xlsx: 7130 samples
✓ Loaded Subject_Subject36.xlsx: 4197 samples
✓ Loaded Subject_Subject5.xlsx: 4258 samples
✓ Loaded Subject_Subject41.xlsx: 2847 samples
✓ Loaded Subject_Subject16.xlsx: 4195 samples
Available clients: ['Subject6', 'Subject39', 'Subject42', 'Subject15', 'Subject54', 'Subject23', 'Subject35', 'Subject19', 'Subject18', 'Subject34', 'Subject22', 'Subject14', 'Subject43', 'Subject38', 'Subject7', 'Subject25', 'Subject33', 'Subject48', 'Subject29', 'Subject44', 'Subject13', 'Subject52', 'Subject53', 'Subject12', 'Subject45', 'Subject28', 'Subject49', 'Subject32', 'Subject24', 'Subject31', 'Subject27', 'Subject50', 'Subject11', 'Subject46', 'Subject3', 'Subject47', 'Subject10', 'Subject51', 'Subject26', 'Subject30', 'Subject17', 'Subject40', 'Subject4', 'Subject37', 'Subject8', 'Subject21', 'Subject20', 'Subject9', 'Subject36', 'Subject5', 'Subject41', 'Subject16']
=== Starting File-Based Federated Learning Benchmark ===
Available subjects: 52
Strategies: ['fedclusterproxxai']

--- Running FedClusterProxXAI ---
Running fedclusterproxxai strategy...
Running 10 rounds with 52 clients
Client Subject6: 3042 train, 761 val samples
Client Subject6: 3042 train, 761 val samples
Client Subject39: 2940 train, 736 val samples
Client Subject42: 3199 train, 800 val samples
Client Subject15: 3431 train, 858 val samples
Client Subject54: 3295 train, 824 val samples
Client Subject23: 3252 train, 813 val samples
Client Subject35: 3228 train, 807 val samples
Client Subject19: 5730 train, 1433 val samples
Client Subject18: 2880 train, 720 val samples
Client Subject34: 3265 train, 817 val samples
  Initial cluster assignments:
    Cluster 0: 4 clients (['Subject39', 'Subject42', 'Subject54', 'Subject35'])
    Cluster 1: 6 clients (['Subject6', 'Subject15', 'Subject23', 'Subject19', 'Subject18', 'Subject34'])
    Cluster 2: 0 clients ([])
Round 1/10
